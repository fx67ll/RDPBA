(self.webpackChunkRDPBA=self.webpackChunkRDPBA||[]).push([[850],{56002:function(Qe,H,n){"use strict";n.r(H),n.d(H,{default:function(){return ve}});var Ve=n(68137),A=n(50532),je=n(25324),N=n(45733),xe=n(13753),S=n(48429),g=n(39428),Je=n(26780),W=n(86444),Y=n(3182),E=n(11849),Ke=n(14643),R=n(92909),Ue=n(67604),D=n(38627),v=n(2824),He=n(97140),L=n(90407),Ne=n(74393),O=n(85637),a=n(67294),de=n(56051),i=n.n(de),ie=n(79416),me=n(33533),oe=n(87557),B=n(72709);function ge(f){return G.apply(this,arguments)}function G(){return G=(0,Y.Z)((0,g.Z)().mark(function f(e){return(0,g.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,B.Z)("/express-api/student/getStudentList",{method:"GET",params:e}));case 1:case"end":return r.stop()}},f)})),G.apply(this,arguments)}function We(f){return Q.apply(this,arguments)}function Q(){return Q=_asyncToGenerator(_regeneratorRuntime().mark(function f(e){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/express-api/student/getStudentById/".concat(e),{method:"GET"}));case 1:case"end":return r.stop()}},f)})),Q.apply(this,arguments)}function fe(f){return V.apply(this,arguments)}function V(){return V=(0,Y.Z)((0,g.Z)().mark(function f(e){return(0,g.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,B.Z)("/express-api/student/createStudent",{method:"POST",data:e}));case 1:case"end":return r.stop()}},f)})),V.apply(this,arguments)}function ce(f){return j.apply(this,arguments)}function j(){return j=(0,Y.Z)((0,g.Z)().mark(function f(e){return(0,g.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,B.Z)("/express-api/student/updateStudentById/".concat(e._id),{method:"PUT",data:e}));case 1:case"end":return r.stop()}},f)})),j.apply(this,arguments)}function pe(f){return x.apply(this,arguments)}function x(){return x=(0,Y.Z)((0,g.Z)().mark(function f(e){return(0,g.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,B.Z)("/express-api/student/deleteStudentById/".concat(e),{method:"DELETE"}));case 1:case"end":return r.stop()}},f)})),x.apply(this,arguments)}var Me=O.Z.RangePicker,k=L.Z.Option,he=function(){var e=(0,oe.YB)(),T=D.Z.useForm(),r=(0,v.Z)(T,1),F=r[0],I=(0,a.useRef)(),Ye=(0,a.useState)(!1),X=(0,v.Z)(Ye,2),J=X[0],z=X[1],ye=(0,a.useState)(!1),q=(0,v.Z)(ye,2),Ze=q[0],P=q[1],Se=(0,a.useState)(""),_=(0,v.Z)(Se,2),De=_[0],ee=_[1],be=(0,a.useState)(),ae=(0,v.Z)(be,2),C=ae[0],te=ae[1],Ee=(0,a.useState)(0),ne=(0,v.Z)(Ee,2),c=ne[0],re=ne[1],Te=(0,a.useState)(null),se=(0,v.Z)(Te,2),y=se[0],K=se[1],Ce=(0,a.useState)(null),le=(0,v.Z)(Ce,2),Z=le[0],U=le[1],Re=(0,a.useState)([]),ue=(0,v.Z)(Re,2),p=ue[0],$=ue[1],ke=function(){var t;re(0),K(null),U(null),$([]),(t=I.current)===null||t===void 0||t.reload()},Ie=function(t){re(t),K(null),U(null),$([])},Pe=function(t){K(t?t.format("YYYY-MM"):null)},we=function(t){U(t?t.format("YYYY-MM-DD"):null)},Oe=function(t){t&&t[0]&&t[1]?$([t[0].format("YYYY-MM-DD"),t[1].format("YYYY-MM-DD")]):$([])},Be=function(){var t="",s="";if(c===0&&y?(t=i()(y).subtract(18,"years").startOf("month").format("YYYY-MM-DD"),s=i()(y).subtract(18,"years").endOf("month").format("YYYY-MM-DD")):c===1&&Z?(t=i()(Z).subtract(18,"years").format("YYYY-MM-DD"),s=i()(Z).subtract(18,"years").format("YYYY-MM-DD")):c===2&&p.length===2&&(t=i()(p[0]).subtract(18,"years").format("YYYY-MM-DD"),s=i()(p[1]).subtract(18,"years").format("YYYY-MM-DD")),t&&s){var u,m;(u=I.current)===null||u===void 0||(m=u.reloadAndRest)===null||m===void 0||m.call(u)}else R.default.error(e.formatMessage({id:"pages.studentManagement.message.searchDateRequired"}))},Fe=function(){ee(e.formatMessage({id:"pages.studentManagement.modal.title.add"})),te(void 0),F.resetFields(),P(!0)},ze=function(t){ee(e.formatMessage({id:"pages.studentManagement.modal.title.edit"})),te(t),F.setFieldsValue((0,E.Z)((0,E.Z)({},t),{},{birth:t.birth?i()(t.birth,"YYYY-MM-DD"):null})),P(!0)},$e=function(){var o=(0,Y.Z)((0,g.Z)().mark(function t(s){return(0,g.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:W.Z.confirm({title:e.formatMessage({id:"pages.studentManagement.deleteConfirm.title"}),content:e.formatMessage({id:"pages.studentManagement.deleteConfirm.content"}),okText:e.formatMessage({id:"pages.studentManagement.deleteConfirm.okText"}),cancelText:e.formatMessage({id:"pages.studentManagement.deleteConfirm.cancelText"}),onOk:function(){var b=(0,Y.Z)((0,g.Z)().mark(function l(){var M;return(0,g.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(h.prev=0,!s._id){h.next=6;break}return h.next=4,pe(s._id);case 4:R.default.success(e.formatMessage({id:"pages.studentManagement.message.deleteSuccess"})),(M=I.current)===null||M===void 0||M.reload();case 6:h.next=11;break;case 8:h.prev=8,h.t0=h.catch(0),R.default.error(e.formatMessage({id:"pages.studentManagement.message.deleteFail"}));case 11:case"end":return h.stop()}},l,null,[[0,8]])}));function w(){return b.apply(this,arguments)}return w}()});case 1:case"end":return m.stop()}},t)}));return function(s){return o.apply(this,arguments)}}(),Ae=function(){var o=(0,Y.Z)((0,g.Z)().mark(function t(){var s,u,m,b,w,l;return(0,g.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,F.validateFields();case 3:if(s=d.sent,u=(0,E.Z)((0,E.Z)({},s),{},{birth:s.birth?s.birth.format("YYYY-MM-DD"):"",_id:C==null?void 0:C._id}),z(!0),m=!1,!(C!=null&&C._id)){d.next=14;break}return d.next=10,ce(u);case 10:b=d.sent,b&&(R.default.success(e.formatMessage({id:"pages.studentManagement.message.updateSuccess"})),m=!0),d.next=18;break;case 14:return d.next=16,fe(u);case 16:w=d.sent,w&&(R.default.success(e.formatMessage({id:"pages.studentManagement.message.addSuccess"})),m=!0);case 18:m&&(P(!1),(l=I.current)===null||l===void 0||l.reload()),d.next=24;break;case 21:d.prev=21,d.t0=d.catch(0),console.error(e.formatMessage({id:"pages.studentManagement.message.submitError"}),d.t0);case 24:return d.prev=24,z(!1),d.finish(24);case 27:case"end":return d.stop()}},t,null,[[0,21,24,27]])}));return function(){return o.apply(this,arguments)}}(),Le=function(){var o=(0,Y.Z)((0,g.Z)().mark(function t(s){var u,m,b;return(0,g.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return z(!0),u={pageIndex:s.current||1,pageSize:s.pageSize||10,startTime:"",endTime:""},c===0&&y?(u.startTime=i()(y).subtract(18,"years").startOf("month").format("YYYY-MM-DD"),u.endTime=i()(y).subtract(18,"years").endOf("month").format("YYYY-MM-DD")):c===1&&Z?(u.startTime=i()(Z).subtract(18,"years").format("YYYY-MM-DD"),u.endTime=i()(Z).subtract(18,"years").format("YYYY-MM-DD")):c===2&&p.length===2&&(u.startTime=i()(p[0]).subtract(18,"years").format("YYYY-MM-DD"),u.endTime=i()(p[1]).subtract(18,"years").format("YYYY-MM-DD")),l.prev=3,l.next=6,ge(u);case 6:if(m=l.sent,console.log("response",m),!(m&&m.status===0)){l.next=11;break}return b=m.data.map(function(M){return(0,E.Z)((0,E.Z)({},M),{},{birth:M.birth?i()(M.birth).format("YYYY-MM-DD"):"",createTime:M.createTime?i()(M.createTime).format("YYYY-MM-DD"):""})}),l.abrupt("return",{data:b,total:m.total,success:!0});case 11:return l.abrupt("return",{data:[],total:0,success:!0});case 14:return l.prev=14,l.t0=l.catch(3),l.abrupt("return",{data:[],total:0,success:!0});case 17:return l.prev=17,z(!1),l.finish(17);case 20:case"end":return l.stop()}},t,null,[[3,14,17,20]])}));return function(s){return o.apply(this,arguments)}}(),Ge=[{title:e.formatMessage({id:"pages.studentManagement.table.index"}),dataIndex:"index",valueType:"indexBorder",width:80},{title:e.formatMessage({id:"pages.studentManagement.table.name"}),dataIndex:"name"},{title:e.formatMessage({id:"pages.studentManagement.table.sex"}),dataIndex:"sex",render:function(t,s){return s.sex?e.formatMessage({id:"pages.studentManagement.table.sexMale"}):e.formatMessage({id:"pages.studentManagement.table.sexFemale"})}},{title:e.formatMessage({id:"pages.studentManagement.table.birth"}),dataIndex:"birth"},{title:e.formatMessage({id:"pages.studentManagement.table.phone"}),dataIndex:"phone"},{title:e.formatMessage({id:"pages.studentManagement.table.remark"}),dataIndex:"bro"},{title:e.formatMessage({id:"pages.studentManagement.table.createTime"}),dataIndex:"createTime"},{title:e.formatMessage({id:"pages.studentManagement.table.operation"}),valueType:"option",width:160,render:function(t,s){return a.createElement(N.Z,{size:"small"},a.createElement(S.Z,{type:"link",size:"small",onClick:function(){return ze(s)}},e.formatMessage({id:"pages.studentManagement.table.edit"})),a.createElement(S.Z,{type:"link",danger:!0,size:"small",onClick:function(){return $e(s)}},e.formatMessage({id:"pages.studentManagement.table.delete"})))}}];return a.createElement(ie.ZP,null,a.createElement("div",{style:{marginBottom:16,padding:24,backgroundColor:"#fff"}},a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},a.createElement(N.Z,{wrap:!0,size:"middle"},a.createElement(L.Z,{placeholder:e.formatMessage({id:"pages.studentManagement.query.placeholder"}),value:c,onChange:Ie,style:{width:130}},a.createElement(k,{value:0},e.formatMessage({id:"pages.studentManagement.query.monthQuery"})),a.createElement(k,{value:1},e.formatMessage({id:"pages.studentManagement.query.dayQuery"})),a.createElement(k,{value:2},e.formatMessage({id:"pages.studentManagement.query.customQuery"}))),c===0&&a.createElement(O.Z,{picker:"month",format:"YYYY-MM",placeholder:e.formatMessage({id:"pages.studentManagement.query.monthPlaceholder"}),value:y?i()(y,"YYYY-MM"):null,onChange:Pe}),c===1&&a.createElement(O.Z,{placeholder:e.formatMessage({id:"pages.studentManagement.query.datePlaceholder"}),value:Z?i()(Z,"YYYY-MM-DD"):null,onChange:we}),c===2&&a.createElement(Me,{placeholder:[e.formatMessage({id:"pages.studentManagement.query.rangeStartPlaceholder"}),e.formatMessage({id:"pages.studentManagement.query.rangeEndPlaceholder"})],value:p[0]&&p[1]?[i()(p[0]),i()(p[1])]:void 0,onChange:Oe}),a.createElement(S.Z,{type:"primary",onClick:Be,loading:J},e.formatMessage({id:"pages.studentManagement.query.searchButton"})),a.createElement(S.Z,{onClick:ke},e.formatMessage({id:"pages.studentManagement.query.resetButton"}))),a.createElement(S.Z,{type:"primary",onClick:Fe},e.formatMessage({id:"pages.studentManagement.query.addButton"})))),a.createElement(me.ZP,{headerTitle:e.formatMessage({id:"pages.studentManagement.table.headerTitle"}),actionRef:I,rowKey:"_id",loading:J,columns:Ge,request:Le,pagination:{defaultPageSize:10,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","30","40","50"]},search:!1,options:!1}),a.createElement(W.Z,{title:De,open:Ze,onCancel:function(){return P(!1)},footer:[a.createElement(S.Z,{key:"cancel",onClick:function(){return P(!1)}},e.formatMessage({id:"pages.studentManagement.modal.cancel"})),a.createElement(S.Z,{key:"submit",type:"primary",loading:J,onClick:Ae},e.formatMessage({id:"pages.studentManagement.modal.ok"}))],width:420,destroyOnClose:!0},a.createElement(D.Z,{form:F,layout:"horizontal",labelCol:{span:6},wrapperCol:{span:16}},a.createElement(D.Z.Item,{label:e.formatMessage({id:"pages.studentManagement.form.label.name"}),name:"name",rules:[{required:!0,message:e.formatMessage({id:"pages.studentManagement.form.validation.nameRequired"})}]},a.createElement(A.Z,{placeholder:e.formatMessage({id:"pages.studentManagement.form.placeholder.name"})})),a.createElement(D.Z.Item,{label:e.formatMessage({id:"pages.studentManagement.form.label.sex"}),name:"sex",rules:[{required:!0,message:e.formatMessage({id:"pages.studentManagement.form.validation.sexRequired"})}]},a.createElement(L.Z,{placeholder:e.formatMessage({id:"pages.studentManagement.form.placeholder.sex"})},a.createElement(k,{value:!0},e.formatMessage({id:"pages.studentManagement.table.sexMale"})),a.createElement(k,{value:!1},e.formatMessage({id:"pages.studentManagement.table.sexFemale"})))),a.createElement(D.Z.Item,{label:e.formatMessage({id:"pages.studentManagement.form.label.birth"}),name:"birth",rules:[{required:!0,message:e.formatMessage({id:"pages.studentManagement.form.validation.birthRequired"})}]},a.createElement(O.Z,{style:{width:"100%"},placeholder:e.formatMessage({id:"pages.studentManagement.form.placeholder.birth"}),format:"YYYY-MM-DD"})),a.createElement(D.Z.Item,{label:e.formatMessage({id:"pages.studentManagement.form.label.phone"}),name:"phone",rules:[{required:!0,message:e.formatMessage({id:"pages.studentManagement.form.validation.phoneRequired"})},{pattern:/^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/,message:e.formatMessage({id:"pages.studentManagement.form.validation.phonePattern"})}]},a.createElement(A.Z,{placeholder:e.formatMessage({id:"pages.studentManagement.form.placeholder.phone"})})),a.createElement(D.Z.Item,{label:e.formatMessage({id:"pages.studentManagement.form.label.remark"}),name:"bro",rules:[{required:!0,message:e.formatMessage({id:"pages.studentManagement.form.validation.remarkRequired"})}]},a.createElement(A.Z,{placeholder:e.formatMessage({id:"pages.studentManagement.form.placeholder.remark"})})))))},ve=he}}]);
