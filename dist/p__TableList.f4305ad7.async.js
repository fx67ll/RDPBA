(self.webpackChunkreact_fx67ll_com=self.webpackChunkreact_fx67ll_com||[]).push([[947],{20123:function(Ee,B,r){"use strict";r.r(B),r.d(B,{default:function(){return pe}});var Te=r(42048),k=r(2812),Me=r(13753),C=r(48429),ye=r(68137),z=r(50532),K=r(91896),x=r(93224),M=r(2824),d=r(39428),Z=r(11849),Fe=r(14643),h=r(92909),p=r(3182),J=r(49101),e=r(67294),l=r(87557),Q=r(72535),X=r(47990),q=r(10053),_=r(72906),V=r(62925),I=r(57581),ee=r(91017),Se=r(26780),ae=r(86444),S=r(81971),w=r(61547),te=r(70571),re=r(74636),se=function(n){var s=(0,l.YB)();return e.createElement(S.L,{stepsProps:{size:"small"},stepsFormRender:function(v,a){return e.createElement(ae.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:s.formatMessage({id:"pages.searchTable.updateForm.ruleConfig",defaultMessage:"\u89C4\u5219\u914D\u7F6E"}),visible:n.updateModalVisible,footer:a,onCancel:function(){n.onCancel()}},v)},onFinish:n.onSubmit},e.createElement(S.L.StepForm,{initialValues:{name:n.values.name,desc:n.values.desc},title:s.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"})},e.createElement(V.Z,{name:"name",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"\u89C4\u5219\u540D\u79F0"}),width:"md",rules:[{required:!0,message:e.createElement(l._H,{id:"pages.searchTable.updateForm.ruleName.nameRules",defaultMessage:"\u8BF7\u8F93\u5165\u89C4\u5219\u540D\u79F0\uFF01"})}]}),e.createElement(I.Z,{name:"desc",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descLabel",defaultMessage:"\u89C4\u5219\u63CF\u8FF0"}),placeholder:s.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26"}),rules:[{required:!0,message:e.createElement(l._H,{id:"pages.searchTable.updateForm.ruleDesc.descRules",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01"}),min:5}]})),e.createElement(S.L.StepForm,{initialValues:{target:"0",template:"0"},title:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.title",defaultMessage:"\u914D\u7F6E\u89C4\u5219\u5C5E\u6027"})},e.createElement(w.Z,{name:"target",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),valueEnum:{0:"\u8868\u4E00",1:"\u8868\u4E8C"}}),e.createElement(w.Z,{name:"template",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.templateLabel",defaultMessage:"\u89C4\u5219\u6A21\u677F"}),valueEnum:{0:"\u89C4\u5219\u6A21\u677F\u4E00",1:"\u89C4\u5219\u6A21\u677F\u4E8C"}}),e.createElement(te.Z.Group,{name:"type",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.typeLabel",defaultMessage:"\u89C4\u5219\u7C7B\u578B"}),options:[{value:"0",label:"\u5F3A"},{value:"1",label:"\u5F31"}]})),e.createElement(S.L.StepForm,{initialValues:{type:"1",frequency:"month"},title:s.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.title",defaultMessage:"\u8BBE\u5B9A\u8C03\u5EA6\u5468\u671F"})},e.createElement(re.Z,{name:"time",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.timeLabel",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),rules:[{required:!0,message:e.createElement(l._H,{id:"pages.searchTable.updateForm.schedulingPeriod.timeRules",defaultMessage:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4\uFF01"})}]}),e.createElement(w.Z,{name:"frequency",label:s.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),width:"md",valueEnum:{month:"\u6708",week:"\u5468"}})))},le=se,H=r(72709);function Re(c){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function c(n){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/rule",{params:n}));case 1:case"end":return t.stop()}},c)})),P.apply(this,arguments)}function ne(c){return A.apply(this,arguments)}function A(){return A=(0,p.Z)((0,d.Z)().mark(function c(n){return(0,d.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,H.Z)("/api/rule",{method:"POST",data:(0,Z.Z)((0,Z.Z)({},n),{},{method:"delete"})}));case 1:case"end":return t.stop()}},c)})),A.apply(this,arguments)}function ue(c){return D.apply(this,arguments)}function D(){return D=(0,p.Z)((0,d.Z)().mark(function c(n){return(0,d.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,H.Z)("/api/rule",{method:"POST",data:(0,Z.Z)((0,Z.Z)({},n),{},{method:"post"})}));case 1:case"end":return t.stop()}},c)})),D.apply(this,arguments)}function ie(c){return L.apply(this,arguments)}function L(){return L=(0,p.Z)((0,d.Z)().mark(function c(n){return(0,d.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,H.Z)("/api/rule",{method:"POST",data:(0,Z.Z)((0,Z.Z)({},n),{},{method:"update"})}));case 1:case"end":return t.stop()}},c)})),L.apply(this,arguments)}var de=["defaultRender"],ce=function(){var c=(0,p.Z)((0,d.Z)().mark(function n(s){var t;return(0,d.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=h.default.loading("Adding"),a.prev=1,a.next=4,ue((0,Z.Z)({},s));case 4:return t(),h.default.success("Added successfully"),a.abrupt("return",!0);case 9:return a.prev=9,a.t0=a.catch(1),t(),h.default.error("Adding failed, please try again!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},n,null,[[1,9]])}));return function(s){return c.apply(this,arguments)}}(),oe=function(){var c=(0,p.Z)((0,d.Z)().mark(function n(s){var t;return(0,d.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=h.default.loading("Configuring"),a.prev=1,a.next=4,ie({name:s.name,desc:s.desc,key:s.key});case 4:return t(),h.default.success("Configuration is successful"),a.abrupt("return",!0);case 9:return a.prev=9,a.t0=a.catch(1),t(),h.default.error("Configuration failed, please try again!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},n,null,[[1,9]])}));return function(s){return c.apply(this,arguments)}}(),me=function(){var c=(0,p.Z)((0,d.Z)().mark(function n(s){var t;return(0,d.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=h.default.loading("Deleting"),s){a.next=3;break}return a.abrupt("return",!0);case 3:return a.prev=3,a.next=6,ne({key:s.map(function(y){return y.key})});case 6:return t(),h.default.success("Deleted successfully and will refresh soon"),a.abrupt("return",!0);case 11:return a.prev=11,a.t0=a.catch(3),t(),h.default.error("Delete failed, please try again"),a.abrupt("return",!1);case 16:case"end":return a.stop()}},n,null,[[3,11]])}));return function(s){return c.apply(this,arguments)}}(),fe=function(){var n=(0,e.useState)(!1),s=(0,M.Z)(n,2),t=s[0],v=s[1],a=(0,e.useState)(!1),y=(0,M.Z)(a,2),ge=y[0],$=y[1],he=(0,e.useState)(!1),N=(0,M.Z)(he,2),ve=N[0],O=N[1],E=(0,e.useRef)(),be=(0,e.useState)(),U=(0,M.Z)(be,2),f=U[0],F=U[1],Ze=(0,e.useState)([]),j=(0,M.Z)(Ze,2),T=j[0],G=j[1],R=(0,l.YB)(),W=[{title:e.createElement(l._H,{id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"Rule name"}),dataIndex:"name",tip:"The rule name is the unique key",render:function(u,i){return e.createElement("a",{onClick:function(){F(i),O(!0)}},u)}},{title:e.createElement(l._H,{id:"pages.searchTable.titleDesc",defaultMessage:"Description"}),dataIndex:"desc",valueType:"textarea"},{title:e.createElement(l._H,{id:"pages.searchTable.titleCallNo",defaultMessage:"Number of service calls"}),dataIndex:"callNo",sorter:!0,hideInForm:!0,renderText:function(u){return"".concat(u).concat(R.formatMessage({id:"pages.searchTable.tenThousand",defaultMessage:" \u4E07 "}))}},{title:e.createElement(l._H,{id:"pages.searchTable.titleStatus",defaultMessage:"Status"}),dataIndex:"status",hideInForm:!0,valueEnum:{0:{text:e.createElement(l._H,{id:"pages.searchTable.nameStatus.default",defaultMessage:"Shut down"}),status:"Default"},1:{text:e.createElement(l._H,{id:"pages.searchTable.nameStatus.running",defaultMessage:"Running"}),status:"Processing"},2:{text:e.createElement(l._H,{id:"pages.searchTable.nameStatus.online",defaultMessage:"Online"}),status:"Success"},3:{text:e.createElement(l._H,{id:"pages.searchTable.nameStatus.abnormal",defaultMessage:"Abnormal"}),status:"Error"}}},{title:e.createElement(l._H,{id:"pages.searchTable.titleUpdatedAt",defaultMessage:"Last scheduled time"}),sorter:!0,dataIndex:"updatedAt",valueType:"dateTime",renderFormItem:function(u,i,g){var b=i.defaultRender,m=(0,x.Z)(i,de),Y=g.getFieldValue("status");return"".concat(Y)==="0"?!1:"".concat(Y)==="3"?e.createElement(z.Z,(0,K.Z)({},m,{placeholder:R.formatMessage({id:"pages.searchTable.exception",defaultMessage:"Please enter the reason for the exception!"})})):b(u)}},{title:e.createElement(l._H,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(u,i){return[e.createElement("a",{key:"config",onClick:function(){$(!0),F(i)}},e.createElement(l._H,{id:"pages.searchTable.config",defaultMessage:"Configuration"})),e.createElement("a",{key:"subscribeAlert",href:"https://procomponents.ant.design/"},e.createElement(l._H,{id:"pages.searchTable.subscribeAlert",defaultMessage:"Subscribe to alerts"}))]}}];return e.createElement(Q.ZP,null,e.createElement(q.ZP,{headerTitle:R.formatMessage({id:"pages.searchTable.title",defaultMessage:"Enquiry form"}),actionRef:E,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[e.createElement(C.Z,{type:"primary",key:"primary",onClick:function(){v(!0)}},e.createElement(J.Z,null)," ",e.createElement(l._H,{id:"pages.searchTable.new",defaultMessage:"New"}))]},columns:W,rowSelection:{onChange:function(u,i){G(i)}}}),(T==null?void 0:T.length)>0&&e.createElement(X.Z,{extra:e.createElement("div",null,e.createElement(l._H,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",e.createElement("a",{style:{fontWeight:600}},T.length)," ",e.createElement(l._H,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0",e.createElement("span",null,e.createElement(l._H,{id:"pages.searchTable.totalServiceCalls",defaultMessage:"Total number of service calls"})," ",T.reduce(function(o,u){return o+u.callNo},0)," ",e.createElement(l._H,{id:"pages.searchTable.tenThousand",defaultMessage:"\u4E07"})))},e.createElement(C.Z,{onClick:(0,p.Z)((0,d.Z)().mark(function o(){var u,i;return(0,d.Z)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,me(T);case 2:G([]),(u=E.current)===null||u===void 0||(i=u.reloadAndRest)===null||i===void 0||i.call(u);case 4:case"end":return b.stop()}},o)}))},e.createElement(l._H,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})),e.createElement(C.Z,{type:"primary"},e.createElement(l._H,{id:"pages.searchTable.batchApproval",defaultMessage:"Batch approval"}))),e.createElement(_.Y,{title:R.formatMessage({id:"pages.searchTable.createForm.newRule",defaultMessage:"New rule"}),width:"400px",visible:t,onVisibleChange:v,onFinish:function(){var o=(0,p.Z)((0,d.Z)().mark(function u(i){var g;return(0,d.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,ce(i);case 2:g=m.sent,g&&(v(!1),E.current&&E.current.reload());case 4:case"end":return m.stop()}},u)}));return function(u){return o.apply(this,arguments)}}()},e.createElement(V.Z,{rules:[{required:!0,message:e.createElement(l._H,{id:"pages.searchTable.ruleName",defaultMessage:"Rule name is required"})}],width:"md",name:"name"}),e.createElement(I.Z,{width:"md",name:"desc"})),e.createElement(le,{onSubmit:function(){var o=(0,p.Z)((0,d.Z)().mark(function u(i){var g;return(0,d.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,oe(i);case 2:g=m.sent,g&&($(!1),F(void 0),E.current&&E.current.reload());case 4:case"end":return m.stop()}},u)}));return function(u){return o.apply(this,arguments)}}(),onCancel:function(){$(!1),F(void 0)},updateModalVisible:ge,values:f||{}}),e.createElement(k.Z,{width:600,visible:ve,onClose:function(){F(void 0),O(!1)},closable:!1},(f==null?void 0:f.name)&&e.createElement(ee.ZP,{column:2,title:f==null?void 0:f.name,request:(0,p.Z)((0,d.Z)().mark(function o(){return(0,d.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",{data:f||{}});case 1:case"end":return i.stop()}},o)})),params:{id:f==null?void 0:f.name},columns:W})))},pe=fe}}]);
